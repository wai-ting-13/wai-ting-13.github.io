<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>146. LRU Cache - Leetbook</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded "><a href="../category/problems-by-number.html">Problems sorted by number</a></li><li class="chapter-item expanded affix "><li class="part-title">Special Categories</li><li class="chapter-item expanded "><a href="../category/my-picks-sql.html">My Picks - SQL</a></li><li class="chapter-item expanded "><a href="../category/sql-50.html">SQL 50</a></li><li class="chapter-item expanded "><a href="../category/leetcode-75.html">LeetCode 75 (In Progress)</a></li><li class="chapter-item expanded affix "><li class="part-title">Solutions divided by hardness</li><li class="chapter-item expanded "><div>Easy</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../easy-problems/1.html">1. Two Sum</a></li><li class="chapter-item expanded "><a href="../easy-problems/9.html">9. Palindrome Number</a></li><li class="chapter-item expanded "><a href="../easy-problems/13.html">13. Roman to Integer</a></li><li class="chapter-item expanded "><a href="../easy-problems/20.html">20. Valid Parentheses</a></li><li class="chapter-item expanded "><a href="../easy-problems/21.html">21. Merge Two Sorted Lists</a></li><li class="chapter-item expanded "><a href="../easy-problems/26.html">26. Remove Duplicates from Sorted Array</a></li><li class="chapter-item expanded "><a href="../easy-problems/27.html">27. Remove Element</a></li><li class="chapter-item expanded "><a href="../easy-problems/58.html">58. Length of Last Word</a></li><li class="chapter-item expanded "><a href="../easy-problems/66.html">66. Plus One</a></li><li class="chapter-item expanded "><a href="../easy-problems/70.html">70. Climbing Stairs</a></li><li class="chapter-item expanded "><a href="../easy-problems/83.html">83. Remove Duplicates from Sorted List</a></li><li class="chapter-item expanded "><a href="../easy-problems/94.html">94. Binary Tree Inorder Traversal</a></li><li class="chapter-item expanded "><a href="../easy-problems/100.html">100. Same Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/104.html">104. Maximum Depth of Binary Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/111.html">111. Minimum Depth of Binary Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/112.html">112. Path Sum</a></li><li class="chapter-item expanded "><a href="../easy-problems/118.html">118. Pascal's Triangle</a></li><li class="chapter-item expanded "><a href="../easy-problems/119.html">119. Pascal's Triangle II</a></li><li class="chapter-item expanded "><a href="../easy-problems/125.html">125. Valid Palindrome</a></li><li class="chapter-item expanded "><a href="../easy-problems/136.html">136. Single Number</a></li><li class="chapter-item expanded "><a href="../easy-problems/141.html">141. Linked List Cycle</a></li><li class="chapter-item expanded "><a href="../easy-problems/144.html">144. Binary Tree Preorder Traversal</a></li><li class="chapter-item expanded "><a href="../easy-problems/145.html">145. Binary Tree Postorder Traversal</a></li><li class="chapter-item expanded "><a href="../easy-problems/175.html">175. Combine Two Tables</a></li><li class="chapter-item expanded "><a href="../easy-problems/181.html">181. Employees Earning More Than Their Managers</a></li><li class="chapter-item expanded "><a href="../easy-problems/182.html">182. Duplicate Emails</a></li><li class="chapter-item expanded "><a href="../easy-problems/183.html">183. Customers Who Never Order</a></li><li class="chapter-item expanded "><a href="../easy-problems/191.html">191. Number of 1 Bits</a></li><li class="chapter-item expanded "><a href="../easy-problems/193.html">193. Valid Phone Numbers</a></li><li class="chapter-item expanded "><a href="../easy-problems/195.html">195. Tenth Line</a></li><li class="chapter-item expanded "><a href="../easy-problems/196.html">196. Delete Duplicate Emails</a></li><li class="chapter-item expanded "><a href="../easy-problems/197.html">197. Rising Temperature</a></li><li class="chapter-item expanded "><a href="../easy-problems/203.html">203. Remove Linked List Elements</a></li><li class="chapter-item expanded "><a href="../easy-problems/206.html">206. Reverse Linked Lists</a></li><li class="chapter-item expanded "><a href="../easy-problems/217.html">217. Contains Duplicate</a></li><li class="chapter-item expanded "><a href="../easy-problems/226.html">226. Invert Binary Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/231.html">231. Power of Two</a></li><li class="chapter-item expanded "><a href="../easy-problems/234.html">234. Palindrome Linked List</a></li><li class="chapter-item expanded "><a href="../easy-problems/242.html">242. Valid Anagram</a></li><li class="chapter-item expanded "><a href="../easy-problems/283.html">283. Move Zeroes</a></li><li class="chapter-item expanded "><a href="../easy-problems/292.html">292. Nim Game</a></li><li class="chapter-item expanded "><a href="../easy-problems/338.html">338. Counting Bits</a></li><li class="chapter-item expanded "><a href="../easy-problems/344.html">344. Reverse String</a></li><li class="chapter-item expanded "><a href="../easy-problems/345.html">345. Reverse Vowels of a String</a></li><li class="chapter-item expanded "><a href="../easy-problems/374.html">374. Guess Number Higher or Lower</a></li><li class="chapter-item expanded "><a href="../easy-problems/392.html">392. Is Subsequence</a></li><li class="chapter-item expanded "><a href="../easy-problems/511.html">511. Game Play Analysis I</a></li><li class="chapter-item expanded "><a href="../easy-problems/577.html">577. Employee Bonus</a></li><li class="chapter-item expanded "><a href="../easy-problems/584.html">584. Find Customer Referee</a></li><li class="chapter-item expanded "><a href="../easy-problems/586.html">586. Customer Placing the Largest Number of Orders</a></li><li class="chapter-item expanded "><a href="../easy-problems/595.html">595. Big Countries</a></li><li class="chapter-item expanded "><a href="../easy-problems/596.html">596. Classes More Than 5 Students</a></li><li class="chapter-item expanded "><a href="../easy-problems/607.html">607. Sales Person</a></li><li class="chapter-item expanded "><a href="../easy-problems/610.html">610. Triangle Judgement</a></li><li class="chapter-item expanded "><a href="../easy-problems/619.html">619. Biggest Single Number</a></li><li class="chapter-item expanded "><a href="../easy-problems/620.html">620. Not Boring Movies</a></li><li class="chapter-item expanded "><a href="../easy-problems/627.html">627. Swap Salary</a></li><li class="chapter-item expanded "><a href="../easy-problems/643.html">643. Maximum Average Subarray I</a></li><li class="chapter-item expanded "><a href="../easy-problems/700.html">700. Search in a Binary Search Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/709.html">709. To Lower Case</a></li><li class="chapter-item expanded "><a href="../easy-problems/724.html">724. Find Pivot Index</a></li><li class="chapter-item expanded "><a href="../easy-problems/746.html">746. Min Cost Climbing Stairs</a></li><li class="chapter-item expanded "><a href="../easy-problems/872.html">872. Leaf-Similar Trees</a></li><li class="chapter-item expanded "><a href="../easy-problems/876.html">876. Middle of the Linked List</a></li><li class="chapter-item expanded "><a href="../easy-problems/897.html">897. Increasing Order Search Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/933.html">933. Number of Recent Calls</a></li><li class="chapter-item expanded "><a href="../easy-problems/1050.html">1050. Actors and Directors Who Cooperated At Least Three Times</a></li><li class="chapter-item expanded "><a href="../easy-problems/1068.html">1068. Product Sales Analysis I</a></li><li class="chapter-item expanded "><a href="../easy-problems/1071.html">1071. Greatest Common Divisor of Strings</a></li><li class="chapter-item expanded "><a href="../easy-problems/1075.html">1075. Project Employees I</a></li><li class="chapter-item expanded "><a href="../easy-problems/1084.html">1084. Sales Analysis III</a></li><li class="chapter-item expanded "><a href="../easy-problems/1137.html">1137. N-th Tribonacci Number</a></li><li class="chapter-item expanded "><a href="../easy-problems/1141.html">1141. User Activity for the Past 30 Days I</a></li><li class="chapter-item expanded "><a href="../easy-problems/1148.html">1148. Article Views I</a></li><li class="chapter-item expanded "><a href="../easy-problems/1179.html">1179. Reformat Department Table</a></li><li class="chapter-item expanded "><a href="../easy-problems/1207.html">1207. Unique Number of Occurrences</a></li><li class="chapter-item expanded "><a href="../easy-problems/1211.html">1211. Queries Quality and Percentage</a></li><li class="chapter-item expanded "><a href="../easy-problems/1251.html">1251. Average Selling Price</a></li><li class="chapter-item expanded "><a href="../easy-problems/1280.html">1280. Students and Examinations</a></li><li class="chapter-item expanded "><a href="../easy-problems/1290.html">1290. Convert Binary Number in a Linked List to Integer</a></li><li class="chapter-item expanded "><a href="../easy-problems/1327.html">1327. List the Products Ordered in a Period</a></li><li class="chapter-item expanded "><a href="../easy-problems/1378.html">1378. Replace Employee ID With The Unique Identifier</a></li><li class="chapter-item expanded "><a href="../easy-problems/1407.html">1407. Top Travellers</a></li><li class="chapter-item expanded "><a href="../easy-problems/1431.html">1431. Kids With the Greatest Number of Candies</a></li><li class="chapter-item expanded "><a href="../easy-problems/1484.html">1484. Group Sold Products By The Date</a></li><li class="chapter-item expanded "><a href="../easy-problems/1517.html">1517. Find Users With Valid E-Mails</a></li><li class="chapter-item expanded "><a href="../easy-problems/1527.html">1527. Patients With a Condition</a></li><li class="chapter-item expanded "><a href="../easy-problems/1581.html">1581. Customer Who Visited but Did Not Make Any Transactions</a></li><li class="chapter-item expanded "><a href="../easy-problems/1587.html">1587. Bank Account Summary II</a></li><li class="chapter-item expanded "><a href="../easy-problems/1633.html">1633. Percentage of Users Attended a Contest</a></li><li class="chapter-item expanded "><a href="../easy-problems/1661.html">1661. Average Time of Process per Machine</a></li><li class="chapter-item expanded "><a href="../easy-problems/1667.html">1667. Fix Names in a Table</a></li><li class="chapter-item expanded "><a href="../easy-problems/1683.html">1683. Invalid Tweets</a></li><li class="chapter-item expanded "><a href="../easy-problems/1693.html">1693. Daily Leads and Partners</a></li><li class="chapter-item expanded "><a href="../easy-problems/1729.html">1729. Find Followers Count</a></li><li class="chapter-item expanded "><a href="../easy-problems/1731.html">1731. The Number of Employees Which Report to Each Employee</a></li><li class="chapter-item expanded "><a href="../easy-problems/1732.html">1732. Find the Highest Altitude</a></li><li class="chapter-item expanded "><a href="../easy-problems/1741.html">1741. Find Total Time Spent by Each Employee</a></li><li class="chapter-item expanded "><a href="../easy-problems/1757.html">1757. Recyclable and Low Fat Products</a></li><li class="chapter-item expanded "><a href="../easy-problems/1768.html">1768. Merge Strings Alternately</a></li><li class="chapter-item expanded "><a href="../easy-problems/1789.html">1789. Primary Department for Each Employee</a></li><li class="chapter-item expanded "><a href="../easy-problems/1795.html">1795. Rearrange Products Table</a></li><li class="chapter-item expanded "><a href="../easy-problems/1822.html">1822. Sign of the Product of an Array</a></li><li class="chapter-item expanded "><a href="../easy-problems/1873.html">1873. Calculate Special Bonus</a></li><li class="chapter-item expanded "><a href="../easy-problems/1890.html">1890. The Latest Login in 2020</a></li><li class="chapter-item expanded "><a href="../easy-problems/1929.html">1929. Concatenation of Array</a></li><li class="chapter-item expanded "><a href="../easy-problems/1965.html">1965. Employees With Missing Information</a></li><li class="chapter-item expanded "><a href="../easy-problems/1978.html">1978. Employees Whose Manager Left the Company</a></li><li class="chapter-item expanded "><a href="../easy-problems/1991.html">1991. Find the Middle Index in Array</a></li><li class="chapter-item expanded "><a href="../easy-problems/2215.html">2215. Find the Difference of Two Arrays</a></li><li class="chapter-item expanded "><a href="../easy-problems/2235.html">2235. Add Two Integers</a></li><li class="chapter-item expanded "><a href="../easy-problems/2331.html">2331. Evaluate Boolean Binary Tree</a></li><li class="chapter-item expanded "><a href="../easy-problems/2356.html">2356. Number of Unique Subjects Taught by Each Teacher</a></li><li class="chapter-item expanded "><a href="../easy-problems/2703.html">2703. Return Length of Arguments Passed</a></li><li class="chapter-item expanded "><a href="../easy-problems/2723.html">2723. Add Two Promises</a></li></ol></li><li class="chapter-item expanded "><div>Medium</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../medium-problems/2.html">2. Add Two Numbers</a></li><li class="chapter-item expanded "><a href="../medium-problems/3.html">3. Longest Substring Without Repeating Characters</a></li><li class="chapter-item expanded "><a href="../medium-problems/6.html">6. Zigzag Conversion</a></li><li class="chapter-item expanded "><a href="../medium-problems/7.html">7. Reverse Integer</a></li><li class="chapter-item expanded "><a href="../medium-problems/11.html">11. Container With Most Water</a></li><li class="chapter-item expanded "><a href="../medium-problems/12.html">12. Integer to Roman</a></li><li class="chapter-item expanded "><a href="../medium-problems/17.html">17. Letter Combination of a Phone Number</a></li><li class="chapter-item expanded "><a href="../medium-problems/19.html">19. Remove Nth Node From End of List</a></li><li class="chapter-item expanded "><a href="../medium-problems/22.html">22. Generate Parentheses</a></li><li class="chapter-item expanded "><a href="../medium-problems/24.html">24. Swap Nodes in Pairs</a></li><li class="chapter-item expanded "><a href="../medium-problems/31.html">31. Next Permutation</a></li><li class="chapter-item expanded "><a href="../medium-problems/39.html">39. Combination Sum</a></li><li class="chapter-item expanded "><a href="../medium-problems/46.html">46. Permutations</a></li><li class="chapter-item expanded "><a href="../medium-problems/47.html">47. Permutations II</a></li><li class="chapter-item expanded "><a href="../medium-problems/50.html">50. Pow(x, n)</a></li><li class="chapter-item expanded "><a href="../medium-problems/55.html">55. Jump Game</a></li><li class="chapter-item expanded "><a href="../medium-problems/56.html">56. Merge Intervals</a></li><li class="chapter-item expanded "><a href="../medium-problems/57.html">57. Insert Interval</a></li><li class="chapter-item expanded "><a href="../medium-problems/62.html">62. Unique Paths</a></li><li class="chapter-item expanded "><a href="../medium-problems/64.html">64. Minimum Path Sum</a></li><li class="chapter-item expanded "><a href="../medium-problems/78.html">78. Subsets</a></li><li class="chapter-item expanded "><a href="../medium-problems/98.html">98. Validate Binary Search Tree</a></li><li class="chapter-item expanded "><a href="../medium-problems/113.html">113. Path Sum II</a></li><li class="chapter-item expanded "><a href="../medium-problems/143.html">143. Reorder List</a></li><li class="chapter-item expanded "><a href="../medium-problems/146.html" class="active">146. LRU Cache</a></li><li class="chapter-item expanded "><a href="../medium-problems/150.html">150. Evaluate Reverse Polish Notation</a></li><li class="chapter-item expanded "><a href="../medium-problems/151.html">151. Reverse Words in a String</a></li><li class="chapter-item expanded "><a href="../medium-problems/155.html">155. Min Stack</a></li><li class="chapter-item expanded "><a href="../medium-problems/167.html">167. Two Sum II - Input Array Is Sorted</a></li><li class="chapter-item expanded "><a href="../medium-problems/176.html">176. Second Highest Salary</a></li><li class="chapter-item expanded "><a href="../medium-problems/178.html">178. Rank Scores</a></li><li class="chapter-item expanded "><a href="../medium-problems/177.html">177. Nth Highest Salary</a></li><li class="chapter-item expanded "><a href="../medium-problems/179.html">179. Largest Number</a></li><li class="chapter-item expanded "><a href="../medium-problems/180.html">180. Consecutive Numbers</a></li><li class="chapter-item expanded "><a href="../medium-problems/184.html">184. Department Highest Salary</a></li><li class="chapter-item expanded "><a href="../medium-problems/198.html">198. House Robber</a></li><li class="chapter-item expanded "><a href="../medium-problems/199.html">199. Binary Tree Right Side View</a></li><li class="chapter-item expanded "><a href="../medium-problems/200.html">200. Number of Islands</a></li><li class="chapter-item expanded "><a href="../medium-problems/207.html">207. Course Schedule</a></li><li class="chapter-item expanded "><a href="../medium-problems/208.html">208. Implement Trie (Prefix Tree)</a></li><li class="chapter-item expanded "><a href="../medium-problems/210.html">210. Course Schedule II</a></li><li class="chapter-item expanded "><a href="../medium-problems/215.html">215. Kth Largest Element in an Array</a></li><li class="chapter-item expanded "><a href="../medium-problems/216.html">216. Combination Sum III</a></li><li class="chapter-item expanded "><a href="../medium-problems/237.html">237. Delete Node in a Linked List</a></li><li class="chapter-item expanded "><a href="../medium-problems/238.html">238. Product of Array Except Self</a></li><li class="chapter-item expanded "><a href="../medium-problems/279.html">279. Perfect Squares</a></li><li class="chapter-item expanded "><a href="../medium-problems/322.html">322. Coin Change</a></li><li class="chapter-item expanded "><a href="../medium-problems/328.html">328. Odd Even Linked List</a></li><li class="chapter-item expanded "><a href="../medium-problems/334.html">334. Increasing Triplet Subsequence</a></li><li class="chapter-item expanded "><a href="../medium-problems/347.html">347. Top K Frequent Elements</a></li><li class="chapter-item expanded "><a href="../medium-problems/371.html">371. Sum of Two Integers</a></li><li class="chapter-item expanded "><a href="../medium-problems/375.html">375. Guess Number Higher or Lower II</a></li><li class="chapter-item expanded "><a href="../medium-problems/435.html">435. Non-overlapping Intervals</a></li><li class="chapter-item expanded "><a href="../medium-problems/443.html">443. String Compression</a></li><li class="chapter-item expanded "><a href="../medium-problems/452.html">452. Minimum Number of Arrows to Burst Balloons</a></li><li class="chapter-item expanded "><a href="../medium-problems/518.html">518. Coin Change II</a></li><li class="chapter-item expanded "><a href="../medium-problems/547.html">547. Number of Provinces</a></li><li class="chapter-item expanded "><a href="../medium-problems/550.html">550. Game Play Analysis IV</a></li><li class="chapter-item expanded "><a href="../medium-problems/570.html">570. Managers with at Least 5 Direct Reports</a></li><li class="chapter-item expanded "><a href="../medium-problems/585.html">585. Investments in 2016</a></li><li class="chapter-item expanded "><a href="../medium-problems/602.html">602. Friend Requests II: Who Has the Most Friends</a></li><li class="chapter-item expanded "><a href="../medium-problems/608.html">608. Tree Node</a></li><li class="chapter-item expanded "><a href="../medium-problems/626.html">626. Exchange Seats</a></li><li class="chapter-item expanded "><a href="../medium-problems/735.html">735. Asteroid Collision</a></li><li class="chapter-item expanded "><a href="../medium-problems/739.html">739. Daily Temperatures</a></li><li class="chapter-item expanded "><a href="../medium-problems/790.html">790. Domino and Tromino Tiling</a></li><li class="chapter-item expanded "><a href="../medium-problems/841.html">841. Keys and Rooms</a></li><li class="chapter-item expanded "><a href="../medium-problems/901.html">901. Online Stock Span</a></li><li class="chapter-item expanded "><a href="../medium-problems/994.html">994. Rotting Oranges</a></li><li class="chapter-item expanded "><a href="../medium-problems/1004.html">1004. Max Consecutive Ones III</a></li><li class="chapter-item expanded "><a href="../medium-problems/1045.html">1045. Customers Who Bought All Products</a></li><li class="chapter-item expanded "><a href="../medium-problems/1070.html">1070. Product Sales Analysis III</a></li><li class="chapter-item expanded "><a href="../medium-problems/1143.html">1143. Longest Common Subsequence</a></li><li class="chapter-item expanded "><a href="../medium-problems/1158.html">1158. Market Analysis I</a></li><li class="chapter-item expanded "><a href="../medium-problems/1161.html">1161. Maximum Level Sum of a Binary Tree</a></li><li class="chapter-item expanded "><a href="../medium-problems/1164.html">1164. Product Price at a Given Date</a></li><li class="chapter-item expanded "><a href="../medium-problems/1174.html">1174. Immediate Food Delivery II</a></li><li class="chapter-item expanded "><a href="../medium-problems/1193.html">1193. Monthly Transactions I</a></li><li class="chapter-item expanded "><a href="../medium-problems/1204.html">1204. Last Person to Fit in the Bus</a></li><li class="chapter-item expanded "><a href="../medium-problems/1268.html">1268. Search Suggestions System</a></li><li class="chapter-item expanded "><a href="../medium-problems/1286.html">1286. Iterator for Combination</a></li><li class="chapter-item expanded "><a href="../medium-problems/1318.html">1318. Minimum Flips to Make a OR b Equal to c</a></li><li class="chapter-item expanded "><a href="../medium-problems/1321.html">1321. Restaurant Growth</a></li><li class="chapter-item expanded "><a href="../medium-problems/1341.html">1341. Movie Rating</a></li><li class="chapter-item expanded "><a href="../medium-problems/1393.html">1393. Capital Gain/Loss</a></li><li class="chapter-item expanded "><a href="../medium-problems/1448.html">1448. Count Good Nodes in Binary Tree</a></li><li class="chapter-item expanded "><a href="../medium-problems/1456.html">1456. Maximum Number of Vowels in a Substring of Given Length</a></li><li class="chapter-item expanded "><a href="../medium-problems/1493.html">1493. Longest Subarray of 1's After Deleting One Element</a></li><li class="chapter-item expanded "><a href="../medium-problems/1657.html">1657. Determine if Two Strings Are Close</a></li><li class="chapter-item expanded "><a href="../medium-problems/1907.html">1907. Count Salary Categories</a></li><li class="chapter-item expanded "><a href="../medium-problems/1926.html">1926. Nearest Exit from Entrance in Maze</a></li><li class="chapter-item expanded "><a href="../medium-problems/1934.html">1934. Confirmation Rate</a></li><li class="chapter-item expanded "><a href="../medium-problems/2095.html">2095. Delete the Middle Node of a Linked List</a></li><li class="chapter-item expanded "><a href="../medium-problems/2130.html">2130. Maximum Twin Sum of a Linked List</a></li><li class="chapter-item expanded "><a href="../medium-problems/2336.html">2336. Smallest Number in Infinite Set</a></li><li class="chapter-item expanded "><a href="../medium-problems/2352.html">2352. Equal Row and Column Pairs</a></li><li class="chapter-item expanded "><a href="../medium-problems/2390.html">2390. Removing Stars From a String</a></li><li class="chapter-item expanded "><a href="../medium-problems/2807.html">2807. Insert Greatest Common Divisors in Linked List</a></li><li class="chapter-item expanded "><a href="../medium-problems/3220.html">3220. Odd and Even Transactions</a></li></ol></li><li class="chapter-item expanded "><div>Hard</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../hard-problems/60.html">60. Permutation Sequence</a></li><li class="chapter-item expanded "><a href="../hard-problems/65.html">65. Valid Number</a></li><li class="chapter-item expanded "><a href="../hard-problems/185.html">185. Department Top Three Salaries</a></li><li class="chapter-item expanded "><a href="../hard-problems/239.html">239. Sliding Window Maximum</a></li><li class="chapter-item expanded "><a href="../hard-problems/262.html">262. Trips and Users</a></li><li class="chapter-item expanded "><a href="../hard-problems/295.html">295. Find Median from Data Stream</a></li><li class="chapter-item expanded "><a href="../hard-problems/601.html">601. Human Traffic of Stadium</a></li><li class="chapter-item expanded "><a href="../hard-problems/1220.html">1220. Count Vowels Permutation</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Leetbook</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="146-lru-cache"><a class="header" href="#146-lru-cache">146. LRU Cache</a></h1>
<h2 id="description-of-the-problem"><a class="header" href="#description-of-the-problem">Description of the Problem</a></h2>
<p>Design a data structure that follows the constraints of a Least Recently Used (LRU) cache.</p>
<p>Implement the <code>LRUCache</code> class:</p>
<ul>
<li><code>LRUCache(int capacity)</code> Initialize the LRU cache with <strong>positive</strong> size <code>capacity</code>.</li>
<li><code>int get(int key)</code> Return the value of the key if the <code>key</code> exists, otherwise return <code>-1</code>.</li>
<li><code>void put(int key, int value)</code> Update the value of the <code>key</code> if the key exists. Otherwise, add the <code>key-value</code> pair to the cache. 
If the number of keys exceeds the <code>capacity</code> from this operation, evict the least recently used key.</li>
</ul>
<p>The functions get and put must each run in <code>O(1)</code> average time complexity.</p>
<p><strong>Example 1:</strong></p>
<pre><code>Input
[&quot;LRUCache&quot;, &quot;put&quot;, &quot;put&quot;, &quot;get&quot;, &quot;put&quot;, &quot;get&quot;, &quot;put&quot;, &quot;get&quot;, &quot;get&quot;, &quot;get&quot;]
[[2], [1, 1], [2, 2], [1], [3, 3], [2], [4, 4], [1], [3], [4]]
Output
[null, null, null, 1, null, -1, null, -1, 3, 4]

Explanation
LRUCache lRUCache = new LRUCache(2);
lRUCache.put(1, 1); // cache is {1=1}
lRUCache.put(2, 2); // cache is {1=1, 2=2}
lRUCache.get(1);    // return 1
lRUCache.put(3, 3); // LRU key was 2, evicts key 2, cache is {1=1, 3=3}
lRUCache.get(2);    // returns -1 (not found)
lRUCache.put(4, 4); // LRU key was 1, evicts key 1, cache is {4=4, 3=3}
lRUCache.get(1);    // return -1 (not found)
lRUCache.get(3);    // return 3
lRUCache.get(4);    // return 4
</code></pre>
<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= capacity &lt;= 3000</code></li>
<li><code>0 &lt;= key &lt;= 10^4</code></li>
<li><code>0 &lt;= value &lt;= 10^5</code></li>
<li>At most <code>2 * 10^5</code> calls will be made to <code>get</code> and <code>put</code>.</li>
</ul>
<h2 id="solution-1---simple-idea-does-not-meet-the-requirement"><a class="header" href="#solution-1---simple-idea-does-not-meet-the-requirement">Solution 1 - Simple Idea (Does not meet the requirement)</a></h2>
<h3 id="explanation"><a class="header" href="#explanation">Explanation</a></h3>
<p>The whole idea is provided by <a href="https://www.youtube.com/watch?v=7ABFKPK2hD4">NeetCode's Video</a>: </p>
<ul>
<li><code>Double-ended queue</code> stores key-value pairs where the head is the least recently used (LRU) element and the tail is the most recently used (MRU) element. </li>
<li><code>HashMap</code> stores the pointer of nodes of the deque. <code>HashMap</code> provides constant time insert and query on average.</li>
</ul>
<p>The following code is just a simplified version of his solution which does not meet the requirement of the problem (<strong>The functions get and put must each run in <code>O(1)</code> average time complexity</strong>). However, once we implmment double-end queue, the following code can be easily modified in order to meet the requirement.</p>
<h3 id="code-rust"><a class="header" href="#code-rust">Code (Rust)</a></h3>
<pre><code class="language-Rust">use std::collections::{HashMap, VecDeque};

struct LRUCache{
    capacity : usize,
    hash_map : HashMap&lt;i32, i32&gt;,
    deque : VecDeque&lt;i32&gt;,
}

impl LRUCache {
    fn new(capacity: i32) -&gt; LRUCache {
        return LRUCache { 
            capacity : capacity.try_into().unwrap(), 
            hash_map: HashMap::new(), 
            deque: VecDeque::new() 
        };
    }

    fn get(&amp;mut self, key : i32) -&gt; i32 {
        if let Some(&amp;value) = self.hash_map.get(&amp;key) {
            self.move_into_back(key);
            return value;
        }
        return -1;
    }

    fn put(&amp;mut self, key : i32, value: i32) {
        if let Some(value_ref) = self.hash_map.get_mut(&amp;key) {
            *value_ref = value; 
            self.move_into_back(key);
            return;
        }
        
        if self.deque.len() &gt;= self.capacity {
            let lru_key = self.deque.pop_front();
            if let Some(lru_key) = lru_key {
                self.hash_map.remove(&amp;lru_key);
            }
        }

        self.hash_map.insert(key.clone(), value.clone());
        self.deque.push_back(key);
    }

    fn move_into_back(&amp;mut self, key : i32){
        let i = self.deque.iter().position(|&amp;x| x == key).unwrap();
        self.deque.remove(i);
        self.deque.push_back(key);
    }
    
}
</code></pre>
<h2 id="solution-2"><a class="header" href="#solution-2">Solution 2</a></h2>
<h3 id="explanation-1"><a class="header" href="#explanation-1">Explanation</a></h3>
<p>It is so difficult to implement Safe LinkedList with Rust. </p>
<p>Fortunately, <a href="https://rust-unofficial.github.io/too-many-lists/index.html"><strong>Learn Rust With Entirely Too Many Linked Lists</strong></a> provides good demostration for the implementation of a safe LinkedList (see: <a href="https://rust-unofficial.github.io/too-many-lists/fourth-final.html">A Bad Safe Deque</a>)</p>
<p>The source code of <code>std::collections::LinkedList</code> also provides a very good demostration for <a href="https://doc.rust-lang.org/src/alloc/collections/linked_list.rs.html#51-54">LinkedList</a>.</p>
<p>Remember to use <strong>Unit Test</strong> when implementing these data strctures, it helps you DEBUG :).</p>
<h3 id="code-rust-1"><a class="header" href="#code-rust-1">Code (Rust)</a></h3>
<p>** For implmentation details of double-end queue, please see <a href="#appendix-a1---implementation-details-of-lrucache-using-safe-deque">Apppendix A1</a></p>
<pre><code class="language-Rust">struct LRUCache {
    cache : base::LRUCache&lt;i32, i32&gt;,
}

impl LRUCache {
    fn new(capacity: i32) -&gt; Self {
        LRUCache {
            cache : base::LRUCache::new(capacity as usize)
        }
    }
    
    fn get(&amp;mut self, key: i32) -&gt; i32 {
        self.cache.get(&amp;key).unwrap_or(-1)
    }
    
    fn put(&amp;mut self, key: i32, value: i32) {
        self.cache.put(key, value);
    }
}

mod base {
    // -- Snip --
    // Please see Appendix A1
}
</code></pre>
<h3 id="complexity"><a class="header" href="#complexity">Complexity</a></h3>
<h4 id="time-complexity"><a class="header" href="#time-complexity">Time Complexity</a></h4>
<ul>
<li>get: \(O(1)\)</li>
<li>put: \(O(1)\)</li>
</ul>
<h4 id="auxiliary-space"><a class="header" href="#auxiliary-space">Auxiliary Space</a></h4>
<ul>
<li>get: \(O(1)\)</li>
<li>put: \(O(1)\)</li>
</ul>
<h2 id="appendix-a1---implementation-details-of-lrucache-using-safe-deque"><a class="header" href="#appendix-a1---implementation-details-of-lrucache-using-safe-deque">Appendix A1 - Implementation Details of <code>LRUCache</code> using Safe Deque</a></h2>
<pre><code class="language-Rust">//! # Least Recently Used Cache 
//! A LRU cache supports Generics with trait bounds.

use std::{hash::Hash, collections::HashMap, cell::RefCell, rc::Rc};

type NodeRef&lt;T&gt; = Rc&lt;RefCell&lt;Node&lt;T&gt;&gt;&gt;;

/// `K` must be `Copy` to remind &quot;callers&quot; that the `K` should be small
/// Otherwise it will be expensive to copy the key. 
pub struct LRUCache&lt;K, V&gt;     
    where 
        K: Copy + Eq + Hash, 
        V: Clone 
{
    capacity: usize,
    hash_map: HashMap&lt;K, NodeRef&lt;(K,V)&gt;&gt;,
    deque: Deque&lt;(K,V)&gt;,
}

/// The idea of the implementation of this deque mostly comes from the  **Learn Rust With Entirely Too Many Linked Lists**
/// see: [A Bad but Safe Doubly-Linked Deque](https://rust-unofficial.github.io/too-many-lists/fourth-final.html)
/// The idea of `unsafe fn unlink_node(&amp;mut self, node: &amp;NodeRef&lt;T&gt;)` comes from the offcial implementation of `std::collections::LinkedList`
struct Deque&lt;T&gt; {
    len: usize,
    front: Option&lt;NodeRef&lt;T&gt;&gt;,
    back: Option&lt;NodeRef&lt;T&gt;&gt;,
}

#[derive(Debug)]
struct Node&lt;T&gt; {
    val: T,
    prev: Option&lt;NodeRef&lt;T&gt;&gt;,
    next: Option&lt;NodeRef&lt;T&gt;&gt;,
}

impl&lt;K, V&gt; LRUCache&lt;K, V&gt; 
    where 
        K: Copy + Eq + Hash, 
        V: Clone 
{
    pub fn new(capacity: usize) -&gt; Self {
        LRUCache {
            capacity,
            hash_map: HashMap::new(),
            deque: Deque::new(),
        }
    }

    pub fn get(&amp;mut self, key: &amp;K) -&gt; Option&lt;V&gt; {
        self.hash_map.get_mut(key).map(|node_ref| {
            unsafe { self.deque.move_node_into_back(node_ref) };
            node_ref.borrow().val.1.clone()
        })
    }

    pub fn put(&amp;mut self, key: K, value: V) {
        if let Some(node_ref) = self.hash_map.get_mut(&amp;key) {
            unsafe { self.deque.move_node_into_back(node_ref) };
            node_ref.borrow_mut().val.1 = value;
            return;
        }

        if self.hash_map.len() &gt;= self.capacity {
            let old_node = self.deque.pop_front_node().unwrap();
            let old_key = &amp;old_node.borrow().val.0;
            self.hash_map.remove(old_key);
        }
        
        let node_ref = Deque::create_node_ref((key, value));
        self.hash_map.insert(key, node_ref.clone());
        unsafe { self.deque.push_back_node(node_ref) };
    }
}

impl&lt;T&gt; Deque&lt;T&gt; {
    /* &quot;Public&quot; Interfaces */    
    fn new() -&gt; Self {
        Deque {
            len: 0,
            front: None,
            back: None,
        }
    }

    #[allow(dead_code)]
    fn push_front(&amp;mut self, val: T) {
        let new_front = Self::create_node_ref(val);
        // Safety: `new_front` is newly created
        unsafe { self.push_front_node(new_front) };
    }

    #[allow(dead_code)]
    fn push_back(&amp;mut self, val: T) {
        let new_back = Self::create_node_ref(val);
        // Safety: `new_back` is newly created
        unsafe { self.push_back_node(new_back) };
    }

    #[allow(dead_code)]
    fn pop_front(&amp;mut self) -&gt; Option&lt;T&gt; {
        self.pop_front_node()
            .map(|old_front| Rc::try_unwrap(old_front).ok().unwrap().into_inner().val)
    }

    #[allow(dead_code)]
    fn pop_back(&amp;mut self) -&gt; Option&lt;T&gt; {
        self.pop_back_node()
            .map(|old_back| Rc::try_unwrap(old_back).ok().unwrap().into_inner().val)
    }

    /* &quot;Private&quot; Auxiliary Functions */
    /// # Safety
    /// The node must have only one strong reference. 
    /// It cause problem when the node is popped later otherwise
    #[allow(dead_code)]
    unsafe fn push_front_node(&amp;mut self, new_front: NodeRef&lt;T&gt;) {
        match self.front.take() {
            Some(old_front) =&gt; {
                old_front.borrow_mut().prev = Some(new_front.clone());
                new_front.borrow_mut().next = Some(old_front);
                new_front.borrow_mut().prev = None;
                self.front = Some(new_front);
            },
            None =&gt; {
                self.front = Some(new_front.clone());
                self.back = Some(new_front);
            }
        }
        self.len += 1;
    }

    /// # Safety
    /// The node must have only one strong reference. 
    /// It cause problem when the node is popped later otherwise
    unsafe fn push_back_node(&amp;mut self, new_back: NodeRef&lt;T&gt;) {
        match self.back.take() {
            Some(old_back) =&gt; {
                old_back.borrow_mut().next = Some(new_back.clone());
                new_back.borrow_mut().prev = Some(old_back);
                new_back.borrow_mut().next = None;
                self.back = Some(new_back);
            },
            None =&gt; {
                self.back = Some(new_back.clone());
                self.front = Some(new_back);
            }
        }
        self.len += 1;
    }

    fn pop_front_node(&amp;mut self) -&gt; Option&lt;NodeRef&lt;T&gt;&gt; {
        self.front.take().map(|old_front| {
            match old_front.borrow_mut().next.take() {
                Some(new_front) =&gt; {
                    new_front.borrow_mut().prev = None;
                    self.front = Some(new_front);
                },
                None =&gt; {
                    self.back = None;
                }
            }
            self.len -= 1;
            old_front
        })
    }

    #[allow(dead_code)]
    fn pop_back_node(&amp;mut self) -&gt; Option&lt;NodeRef&lt;T&gt;&gt; {
        self.back.take().map(|old_back| {
            match old_back.borrow_mut().prev.take() {
                Some(new_back) =&gt; {
                    new_back.borrow_mut().next = None;
                    self.back = Some(new_back);
                },
                None =&gt; {
                    self.front = None;
                }
            }
            self.len -= 1;
            old_back
        })
    }

    /// # Safety
    /// see reason from the below method
    unsafe fn move_node_into_back(&amp;mut self, node: &amp;NodeRef&lt;T&gt;) {
        unsafe { self.unlink_node(node) };
        self.push_back_node(node.clone());
    }

    /// # Safety
    /// Warning: it does not check whether `node` belongs to the lists.
    unsafe fn unlink_node(&amp;mut self, node: &amp;NodeRef&lt;T&gt;) {
        let prev = node.borrow_mut().prev.take();
        let next = node.borrow_mut().next.take();

        if let Some(ref prev) = prev {
            prev.borrow_mut().next = next.clone();
        } else {
            self.front = next.clone();
        }

        if let Some(ref next) = next {
            next.borrow_mut().prev = prev;
        } else {
            self.back = prev;
        }

        self.len -= 1;
    }

    fn create_node_ref(val : T) -&gt; NodeRef&lt;T&gt; {
        Rc::new(RefCell::new(Node::new(val)))
    }
}

impl&lt;T&gt; Node&lt;T&gt; {
    fn new(val: T) -&gt; Self {
        Node { val, prev: None, next: None }
    }
}



#[cfg(test)]
mod cache_tests{
    use crate::LRUCache;

    #[test]
    fn test_01(){
        let mut cache = LRUCache::new(2);
        cache.put(1,1);
        cache.put(2,2);
        assert_eq!(cache.get(&amp;1),Some(1));
        cache.put(3,3); 
        assert_eq!(cache.get(&amp;2),None); 
        cache.put(4,4); 
        assert_eq!(cache.get(&amp;1),None); 
        assert_eq!(cache.get(&amp;3),Some(3));
        assert_eq!(cache.get(&amp;4),Some(4));
    }

    #[test]
    fn test_02(){
        let mut cache = LRUCache::new(2);
        cache.put(1,1); 
        cache.put(2,2); 
        assert_eq!(cache.get(&amp;1),Some(1)); 
        cache.put(2,3);
        assert_eq!(cache.get(&amp;2),Some(3)); 
        cache.put(2,3);
    }


}

#[cfg(test)]
mod deque_tests {
    use crate::Deque;

    #[test]
    fn pop_front_test(){
        let mut deque = Deque::&lt;i32&gt;::new();
        deque.push_front(3);
        deque.push_front(2);
        deque.push_front(1);

        deque.push_back(4);
        deque.push_back(5);
        deque.push_back(6);
        
        assert_eq!(deque.pop_front(), Some(1));
        assert_eq!(deque.pop_front(), Some(2));
        assert_eq!(deque.pop_front(), Some(3));
        assert_eq!(deque.pop_front(), Some(4));
        assert_eq!(deque.pop_front(), Some(5));
        assert_eq!(deque.pop_front(), Some(6));
    }

    // Pop Back Test
    #[test]
    fn pop_back_test(){
        let mut deque = Deque::&lt;i32&gt;::new();
        deque.push_front(3);
        deque.push_front(2);
        deque.push_front(1);

        deque.push_back(4);
        deque.push_back(5);
        deque.push_back(6);

        assert_eq!(deque.pop_back(), Some(6));
        assert_eq!(deque.pop_back(), Some(5));
        assert_eq!(deque.pop_back(), Some(4));
        assert_eq!(deque.pop_back(), Some(3));
        assert_eq!(deque.pop_back(), Some(2));
        assert_eq!(deque.pop_back(), Some(1));
    }

    // Push Test
    #[test]
    fn push_test(){
        let mut deque = Deque::&lt;i32&gt;::new();
        deque.push_front(3);
        deque.push_front(2);
        deque.push_front(1);

        deque.push_back(4);
        deque.push_back(5);
        deque.push_back(6);

        let mut front = deque.front.clone();
        for i in 1..=6 {
            if let Some(node) = front.clone() {
                let val = node.borrow().val;
                assert_eq!(val, i);
            } else{
                panic!(&quot;There should be an element in the list&quot;);
            }

            front = front.and_then(
                |rc| {
                    let rc = rc.borrow(); 
                    let rc = rc.next.clone(); 
                    rc
                }
            );
        }

        let mut back = deque.back.clone();
        for i in (1..=6).rev() {
            if let Some(node) = back.clone() {
                let val = node.borrow().val;
                assert_eq!(val, i);
            } else{
                panic!(&quot;There should be an element in the list&quot;);
            }

            back = back.and_then(
                |rc| {
                    let rc = rc.borrow(); 
                    let rc = rc.prev.clone(); 
                    rc
                }
            );
        }
    }

    // unlink test
    #[test]
    fn unlink_test(){
        unsafe {
            let mut deque = Deque::&lt;i32&gt;::new();
            let node_6 = Deque::create_node_ref(6);
            let node_5 = Deque::create_node_ref(5);
            let node_4 = Deque::create_node_ref(4);
            let node_3 = Deque::create_node_ref(3);
            let node_2 = Deque::create_node_ref(2);
            let node_1 = Deque::create_node_ref(1);

            deque.push_front_node(node_3.clone());
            deque.push_front_node(node_2);
            deque.push_front_node(node_1);

            deque.push_back_node(node_4);
            deque.push_back_node(node_5);
            deque.push_back_node(node_6);

            deque.unlink_node(&amp;node_3);

            for i in &amp;[1,2,4,5,6] {
                let i = *i;
                let j = deque.pop_front().unwrap();
                assert_eq!(i, j);
            }
        }
    }
}
</code></pre>
<h2 id="appendix-a2---implementation-of-lrucache-using-stdcollectionslinked_listlinkedlist"><a class="header" href="#appendix-a2---implementation-of-lrucache-using-stdcollectionslinked_listlinkedlist">Appendix A2 - Implementation of <code>LRUCache</code> using <code>std::collections::linked_list::LinkedList</code></a></h2>
<pre><code class="language-Rust">//! # Least Recently Used Cache 
//! Using unsafe `LinkedList` from std::collections::linked_list

use std::{collections::HashMap, hash::Hash, marker::PhantomData, ptr::NonNull};

type NodePtr&lt;T&gt; = NonNull&lt;Node&lt;T&gt;&gt;;

pub struct LRUCache&lt;K, V&gt;     
    where 
        K: Copy + Eq + Hash, 
        V: Clone 
{
    capacity: usize,
    hash_map: HashMap&lt;K, NodePtr&lt;(K,V)&gt;&gt;,
    deque: LinkedList&lt;(K,V)&gt;,
}

struct LinkedList&lt;T&gt; {
    len: usize,
    front: Option&lt;NodePtr&lt;T&gt;&gt;,
    back: Option&lt;NodePtr&lt;T&gt;&gt;,
    _marker: PhantomData&lt;Box&lt;Node&lt;T&gt;&gt;&gt;,
}

#[derive(Debug)]
struct Node&lt;T&gt; {
    val: T,
    prev: Option&lt;NodePtr&lt;T&gt;&gt;,
    next: Option&lt;NodePtr&lt;T&gt;&gt;,
}

impl&lt;K, V&gt; LRUCache&lt;K, V&gt; 
    where 
        K: Copy + Eq + Hash, 
        V: Clone 
{
    pub fn new(capacity: usize) -&gt; Self {
        LRUCache {
            capacity,
            hash_map: HashMap::new(),
            deque: LinkedList::new()
        }
    }

    pub fn get(&amp;mut self, key: &amp;K) -&gt; Option&lt;V&gt; {
        self.hash_map.get_mut(key).map(|node_ptr| unsafe {
            self.deque.move_node_into_back(*node_ptr);
            (*node_ptr.as_ptr()).val.1.clone()
        })
    }

    pub fn put(&amp;mut self, key: K, value: V) {
        if let Some(node_ptr) = self.hash_map.get_mut(&amp;key)  {
            unsafe {
                self.deque.move_node_into_back(*node_ptr);
                (*node_ptr.as_ptr()).val.1 = value;
                return;
            }
        }

        if self.hash_map.len() &gt;= self.capacity {
            let old_node = self.deque.pop_front_node().unwrap();
            let old_key = (*old_node).val.0;
            self.hash_map.remove(&amp;old_key);
        }
        
        let node_ptr = LinkedList::create_node_ptr((key, value));
        self.hash_map.insert(key, node_ptr.clone());
        unsafe { self.deque.push_back_node(node_ptr) };
    }
}

// The implementation is copied and modified from `std::collections::linked_list`
impl&lt;T&gt; LinkedList&lt;T&gt; {
    fn new() -&gt; Self {
        LinkedList {
            len: 0,
            front: None,
            back: None,
            _marker: PhantomData,
        }
    }

    #[allow(unused)]
    unsafe fn push_front_node(&amp;mut self, node: NonNull&lt;Node&lt;T&gt;&gt;) {
        unsafe {
            (*node.as_ptr()).next = self.front;
            (*node.as_ptr()).prev = None;
            let node = Some(node);

            match self.front {
                None =&gt; self.back = node,
                Some(front) =&gt; (*front.as_ptr()).prev = node,
            }

            self.front = node;
            self.len += 1;
        }
    }

    #[allow(unused)]
    unsafe fn push_back_node(&amp;mut self, node: NonNull&lt;Node&lt;T&gt;&gt;) {
        unsafe {
            (*node.as_ptr()).next = None;
            (*node.as_ptr()).prev = self.back;
            let node = Some(node);

            match self.back {
                None =&gt; self.front = node,
                Some(back) =&gt; (*back.as_ptr()).next = node,
            }

            self.back = node;
            self.len += 1;
        }
    }

    fn pop_front_node(&amp;mut self) -&gt; Option&lt;Box&lt;Node&lt;T&gt;&gt;&gt; {
        self.front.map(|node| unsafe {
            let node = Box::from_raw(node.as_ptr());
            self.front = node.next;

            match self.front {
                None =&gt; self.back = None,
                Some(front) =&gt; (*front.as_ptr()).prev = None,
            }

            self.len -= 1;
            node
        })
    }

    #[allow(unused)]
    fn pop_back_node(&amp;mut self) -&gt; Option&lt;Box&lt;Node&lt;T&gt;&gt;&gt; {
        self.back.map(|node| unsafe {
            let node = Box::from_raw(node.as_ptr());
            self.back = node.prev;

            match self.back {
                None =&gt; self.front = None,
                Some(back) =&gt; (*back.as_ptr()).next = None,
            }

            self.len -= 1;
            node
        })
    }

    /// # Safety
    /// see reason from the below method
    unsafe fn move_node_into_back(&amp;mut self, node: NodePtr&lt;T&gt;) {
        unsafe { self.unlink_node(node) };
        self.push_back_node(node.clone());
    }

    unsafe fn unlink_node(&amp;mut self, mut node: NonNull&lt;Node&lt;T&gt;&gt;) {
        let node = unsafe { node.as_mut() };

        match node.prev {
            Some(prev) =&gt; unsafe { (*prev.as_ptr()).next = node.next },
            None =&gt; self.front = node.next,
        };

        match node.next {
            Some(next) =&gt; unsafe { (*next.as_ptr()).prev = node.prev },
            None =&gt; self.back = node.prev,
        };

        self.len -= 1;
    }

    fn create_node_ptr(val: T) -&gt; NodePtr&lt;T&gt; {
        let node = Box::leak(Box::new(Node::new(val)));
        NonNull::new(node).unwrap()
    }
}

impl&lt;T&gt; Node&lt;T&gt; {
    fn new(val: T) -&gt; Self {
        Node { val, prev: None, next: None }
    }
}



#[cfg(test)]
mod cache_tests{
    use crate::LRUCache;

    #[test]
    fn test_01(){
        let mut cache = LRUCache::new(2);
        cache.put(1,1);
        cache.put(2,2);
        assert_eq!(cache.get(&amp;1),Some(1));
        cache.put(3,3); 
        assert_eq!(cache.get(&amp;2),None); 
        cache.put(4,4); 
        assert_eq!(cache.get(&amp;1),None); 
        assert_eq!(cache.get(&amp;3),Some(3));
        assert_eq!(cache.get(&amp;4),Some(4));
    }

    #[test]
    fn test_02(){
        let mut cache = LRUCache::new(2);
        cache.put(1,1); 
        cache.put(2,2); 
        assert_eq!(cache.get(&amp;1),Some(1)); 
        cache.put(2,3);
        assert_eq!(cache.get(&amp;2),Some(3)); 
        cache.put(2,3);
    }
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../medium-problems/143.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../medium-problems/150.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../medium-problems/143.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../medium-problems/150.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
